---
title: "R Notebook"
output: html_notebook
---
Limpiando la data de Inversión del Estado en Educación:

```{r}
pbedu= pbedu[,-2:-54]

```

Eliminamos filas que no necesitamos
```{r}
pbedu=pbedu[-1:-2,]
pbedu=pbedu[-1,]
```
Cambiamos de nombre a nuestros columnas:
```{r}
names(pbedu) = c("pais", "2010","2011","2012", "2013","2014","2015", "2016","2017","2018", "2019")
#eliminare la columna del 2019 ya que hay no encuentro datos 
pbedu$'2019'=NULL

names(pbedu)=c("Pais","inveredu")
```
Le quitamos los espacios en blanco
```{r}
pbedu$Pais= trimws(pbedu$Pais, whitespace=)

```
Limpiamos los nombres y eliminamos lo innecesario
```{r}
pbedu[!complete.cases(pbedu),]
pbedu[pbedu$Pais=='Cote d’Ivoire',"Pais"]="Cote d'Ivoire"
pbedu[pbedu$Pais=='Bahamas, The',"Pais"]="Bahamas"

pbedu[pbedu$Pais=='Congo, Dem. Rep.',"Pais"]="Democratic Republic of the Congo"
pbedu[pbedu$Pais=='Congo, Rep.',"Pais"]="Republic of the Congo"
pbedu=pbedu[c(-32,-35) ,]
pbedu=pbedu[c(-56,-57) ,]
pbedu=pbedu[-64 ,]
pbedu=pbedu[c(-61,-62) ,]
```

Ahora exportamos la base de datos:
```{r}
library(rio)
export(pbedu,"pbedu.xlsx")

```

Luego de ver lso datos, se observa que la variable inversi?n en educaci?n tiene muchos casos perdidos. 
Se busca otra data. 
```{r}
library(htmltab)
 url1= "https://datosmacro.expansion.com/estado/gasto/educacion" 

invereduc = htmltab(doc = url1, 
               which ='//*[@id="node-10961"]/div[4]/div/div[2]',
               encoding = "UTF-8") 
```
Eliminaremos las columnas que no necesitamos 
```{r}
invereduc=invereduc[ ,c(-2:-4)]
invereduc=invereduc[ ,c(-4:-7)]
invereduc=invereduc[,-2]

```
Ahora cambiaremos los nombres de nuestras columnas:
```{r}
names(invereduc)=c("Pais","gastoedu")
```
Ahora eliminamos los porcentajes y los m?s 
```{r}
invereduc$Pais =gsub(" [+]", "", invereduc$Pais)
invereduc$gastoedu =gsub("\\%", "", invereduc$gastoedu)
invereduc$gastoedu =gsub("\\,", ".", invereduc$gastoedu)
#tambien cambiamos las comas por los puntos 
invereduc$gastoedu =gsub("\\,", ".", invereduc$gastoedu)
```
Juntamos las dos datas
```{r}
inversionesta=merge(invereduc,pbicap,all.x = T, all.y = T)

```
Al juntar las datas nos damos cuentas que tenemos nombres repetidos, entonces cambairemos los nombres en una data y luego volveremos a juntar. 
```{r}
inversionesta[!complete.cases(inversionesta),]
#reemplazamos las vocales con tilde por vocales sin tilde
invereduc$Pais =gsub("", "i", invereduc$Pais)
invereduc$Pais =gsub("?", "a", invereduc$Pais)
invereduc$Pais =gsub("?", "e", invereduc$Pais)
invereduc$Pais =gsub("?", "o", invereduc$Pais)
invereduc$Pais =gsub("?", "u", invereduc$Pais)
```

Verificamos nuestras variables 
```{r}
str(invereduc)
#cambiamos nuestra variables a numericas
invereduc$gastoedu=as.numeric(invereduc$gastoedu)
#varificamos con un sumari 
summary(invereduc)
```

Exportar la data 

```{r}

export(invereduc,"invereduces.xlsx")

```
Limpiando data de proporcion de maestros por calse 

Eliminamos las columnas que no necesitamos 

```{r}
maestros= maestros[,-2:-54]

```

Eliminamos filas que no necesitamos
```{r}
maestros=maestros[-1:-2,]
maestros=maestros[-1,]
```
Cambiamos de nombre a nuestros columnas:
```{r}
names(maestros) = c("pais", "2010","2011","2012", "2013","2014","2015", "2016","2017","2018", "2019")
#eliminare la columna del 2019 ya que hay no encuentro datos 
maestros$'2019'=NULL
export(maestros,"maestrosxestu.xlsx")

```
En Excel juntamos los datos para tener elmas cercano, ahroa cambiamos nombres, borramos tildes y espacios en balnco 
```{r}
names(maestroxestu)=c("Pais","profxes")

maestroxestu[!complete.cases(maestroxestu),]
#reemplazamos las vocales con tilde por vocales sin tilde
maestroxestu$Pais=gsub("í", "i", maestroxestu$Pais)
maestroxestu$Pais =gsub("á", "a", maestroxestu$Pais)
maestroxestu$Pais =gsub("é", "e", maestroxestu$Pais)
maestroxestu$Pais =gsub("ó", "o", maestroxestu$Pais)
maestroxestu$Pais =gsub("ú", "u", maestroxestu$Pais)
maestroxestu$Pais =gsub("Á", "A", maestroxestu$Pais)

#juntamos la data de nuevo 
data=merge(invereduc1,maestroxestu,all.x = T, all.y = T)

```
En la data juntada se ven valores y paises qe no deseamos, entonces los liminamos 
```{r}
maestroxestu=maestroxestu[c(-5,-6,-34,-47,-59:-63,-66,-71:-72,-77,-96,-108,-100:-106,-127,-132:-134,-137,
                            -138,-140,-144:-145,-151,-154,-159,-168,-179,-181,-189,-194:-197,-220,-236,-242,-243,-246) ,]
maestroxestu=maestroxestu[-36:-37,]
maestroxestu=maestroxestu[-188,]
```
Cambiamos nombres
```{r}
#Cambiamos los nombres
maestroxestu[maestroxestu$Pais=='Braheim',"Pais"]="Bahrein"
maestroxestu[maestroxestu$Pais=='Brunei Darussalam',"Pais"]="Brunei"
maestroxestu[maestroxestu$Pais=='Congo',"Pais"]="Republica del Congo"
maestroxestu[maestroxestu$Pais=='Corea, Republica de',"Pais"]="Corea del Sur"
maestroxestu[maestroxestu$Pais=='Egipto, Republica Arabe de',"Pais"]="Egipto"
maestroxestu[maestroxestu$Pais=='Hong Kong, Region Administrativa Especial',"Pais"]="Hong Kong"
maestroxestu[maestroxestu$Pais=='Iran, Republica Islamica del',"Pais"]="Iran"
maestroxestu[maestroxestu$Pais=='Kazajstan',"Pais"]="Kazajistan"
maestroxestu[maestroxestu$Pais=='Kenya',"Pais"]="Kenia"
maestroxestu[maestroxestu$Pais=='Nueva Zelandia',"Pais"]="Nueva Zelanda"
maestroxestu[maestroxestu$Pais=='Rwanda',"Pais"]="Ruanda"
maestroxestu[maestroxestu$Pais=='Zimbabwe',"Pais"]="Zimbabue"
maestroxestu[maestroxestu$Pais=='Fiji',"Pais"]="Fiyi"
maestroxestu[maestroxestu$Pais=='Qatar',"Pais"]="Catar"
maestroxestu[maestroxestu$Pais=='Djibouti',"Pais"]="Yibuti"
maestroxestu[maestroxestu$Pais=='Federacion de Rusia',"Pais"]="Rusia"
maestroxestu[maestroxestu$Pais=='Yemen, Rep. del',"Pais"]="Yemen"
```
Verificamos nuestras variables 
```{r}
str(maestroxestu)
#cambiamos nuestra variables a numericas
maestroxestu$profxes=as.numeric(maestroxestu$profxes)
#varificamos con un sumari 
summary(maestrosxestu)

```
Ahora juntamos las dos bases de datos

```{r}
estatalin=merge(invereduc,maestroxestu,all.x = T, all.y = T)
str(estatalin)
#le quitamos espacios en blanco
estatalin$Pais=trimws(estatalin$Pais,whitespace = "[\\h\\v]")
```
Exportamos las tres bases de datos:
```{r}
export(estatalin,"estatalin11.csv")
export(maestroxestu,"maestroxestu11.csv")
export(invereduc,"invereduc11.csv")

```

















